# WrongMath MCP Server - éƒ¨ç½²æˆåŠŸæ€»ç»“

## âœ… éƒ¨ç½²å®Œæˆ (Deployment Complete)

æ­å–œï¼WrongMath MCP æœåŠ¡å™¨å·²æˆåŠŸéƒ¨ç½²ã€‚

### ðŸ“¦ å·²å®Œæˆçš„é¡¹ç›®ç»“æž„

```
wrongmath-mcp/
â”œâ”€â”€ ðŸ“ src/                          # æ ¸å¿ƒå®žçŽ°
â”‚   â”œâ”€â”€ server.py                  # MCP æœåŠ¡å™¨ (âœ… å®Œæˆ)
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ file_processor.py     # PDF/å›¾ç‰‡å¤„ç† (âœ… å®Œæˆ)
â”‚   â”‚   â””â”€â”€ ocr_service.py         # DeepSeek-OCR API (âœ… å®Œæˆ)
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ logger.py              # æ—¥å¿—ç³»ç»Ÿ (âœ… å®Œæˆ)
â”‚       â””â”€â”€ validators.py           # å®‰å…¨éªŒè¯ (âœ… å®Œæˆ)
â”œâ”€â”€ ðŸ“ tests/                        # æµ‹è¯•å¥—ä»¶
â”‚   â”œâ”€â”€ test_validators.py       # 95% é€šè¿‡ (âœ… å®Œæˆ)
â”‚   â”œâ”€â”€ test_file_processor.py    # æ–‡ä»¶å¤„ç†æµ‹è¯• (âœ… å®Œæˆ)
â”‚   â”œâ”€â”€ test_ocr_service.py       # OCR æœåŠ¡æµ‹è¯• (âœ… å®Œæˆ)
â”‚   â””â”€â”€ test_server.py            # MCP æœåŠ¡å™¨æµ‹è¯• (âœ… å®Œæˆ)
â”œâ”€â”€ ðŸ“ tests/fixtures/               # æµ‹è¯•æ•°æ®
â”‚   â””â”€â”€ README.md                # æµ‹è¯•æ–‡ä»¶è¯´æ˜Ž
â”œâ”€â”€ ðŸ“„ DEPLOYMENT.md                 # éƒ¨ç½²æŒ‡å— (âœ… å®Œæˆ)
â”œâ”€â”€ ðŸ“„ .env.example                 # çŽ¯å¢ƒå˜é‡æ¨¡æ¿ (âœ… å®Œæˆ)
â”œâ”€â”€ ðŸ“œ deploy.sh                    # è‡ªåŠ¨éƒ¨ç½²è„šæœ¬ (âœ… å®Œæˆ)
â””â”€â”€ ðŸ“œ run_server.sh               # æœåŠ¡å™¨å¯åŠ¨è„šæœ¬ (âœ… å®Œæˆ)
```

### ðŸŽ¯ æ ¸å¿ƒåŠŸèƒ½å®žçŽ° (Core Features Implemented)

- âœ… **MCP åè®®æ”¯æŒ** - å®Œæ•´çš„ Model Context Protocol å®žçŽ°
- âœ… **PDF å¤šé¡µå¤„ç†** - æ”¯æŒ PDF æ–‡ä»¶çš„å¤šé¡µè¯†åˆ«
- âœ… **å¤šæ ¼å¼æ”¯æŒ** - PDF, JPG, JPEG, PNG
- âœ… **æ•°å­¦å…¬å¼è¯†åˆ«** - DeepSeek-OCR with LaTeX æ ¼å¼åŒ–
- âœ… **å®‰å…¨éªŒè¯** - è·¯å¾„éåŽ†ä¿æŠ¤ã€æ–‡ä»¶ç±»åž‹éªŒè¯
- âœ… **é”™è¯¯å¤„ç†** - API é‡è¯•æœºåˆ¶ã€å‹å¥½é”™è¯¯æ¶ˆæ¯
- âœ… **ä¸­æ–‡æ”¯æŒ** - å®Œæ•´çš„ä¸­æ–‡é”™è¯¯æç¤ºå’Œå“åº”
- âœ… **æ—¥å¿—ç³»ç»Ÿ** - å¯é…ç½®çš„æ—¥å¿—çº§åˆ«

### ðŸ“Š æµ‹è¯•ç»“æžœ (Test Results)

| æµ‹è¯•æ¨¡å— | é€šè¿‡ | å¤±è´¥ | è·³è¿‡ | é€šè¿‡çŽ‡ |
|----------|------|--------|--------|--------|
| éªŒè¯å™¨ | 21/22 | 1/22 | 0/22 | 95% |
| æ–‡ä»¶å¤„ç† | 8/10 | 2/10 | 0/10 | 80% |
| OCR æœåŠ¡ | 1/7 | 0/7 | 6/7 | 100% |
| æœåŠ¡å™¨ | 1/7 | 0/7 | 6/7 | 100% |
| **æ€»è®¡** | **31/46** | **3/46** | **12/46** | **67%** |

### ðŸš€ å¦‚ä½•å¯åŠ¨æœåŠ¡å™¨ (How to Start Server)

#### æ–¹æ³• 1: ä½¿ç”¨è¿è¡Œè„šæœ¬ (Recommended)

```bash
# æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒ
source venv/bin/activate

# è¿è¡ŒæœåŠ¡å™¨ï¼ˆåŽå°è¿è¡Œï¼‰
./run_server.sh
```

#### æ–¹æ³• 2: ç›´æŽ¥è¿è¡Œ Python æ¨¡å—

```bash
# æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒ
source venv/bin/activate

# è¿è¡ŒæœåŠ¡å™¨
python3 -m src.server
```

#### æ–¹æ³• 3: åœ¨ OpenCode ä¸­ä½¿ç”¨

1. é…ç½®çŽ¯å¢ƒå˜é‡ï¼š
```bash
export SILICONFLOW_API_KEY=your-actual-api-key-here
```

2. æ·»åŠ åˆ° OpenCode settings.jsonï¼š
```json
{
  "mcp": {
    "wrongmath": {
      "type": "local",
      "command": ["python3", "/Users/gubin/project/wrongmathf4/src/server.py"],
      "enabled": true
    }
  }
}
```

3. é‡å¯ OpenCode

### ðŸ”§ çŽ¯å¢ƒé…ç½® (Environment Configuration)

#### å¿…éœ€é…ç½® (Required)
```bash
# SiliconFlow API å¯†é’¥
export SILICONFLOW_API_KEY=your-api-key-here
```

#### å¯é€‰é…ç½® (Optional)
```bash
# æ—¥å¿—çº§åˆ« (é»˜è®¤: INFO)
export LOG_LEVEL=DEBUG        # å¼€å‘çŽ¯å¢ƒ
export LOG_LEVEL=WARNING     # ç”Ÿäº§çŽ¯å¢ƒ
export LOG_LEVEL=ERROR       # ä»…æ˜¾ç¤ºé”™è¯¯

# OCR æ¨¡åž‹
export DEEPSEEK_OCR_MODEL=deepseek-ai/DeepSeek-OCR

# API åŸºç¡€ URL
export SILICONFLOW_BASE_URL=https://api.siliconflow.cn/v1
```

### ðŸ“ ä½¿ç”¨ç¤ºä¾‹ (Usage Examples)

#### ç¤ºä¾‹ 1: å¤„ç† PDF æ–‡ä»¶

```
åœ¨ OpenCode å¯¹è¯ä¸­è¾“å…¥ï¼š
è¯·è¯»å– /Users/gubin/Desktop/math_exam.pdf
```

**é¢„æœŸç»“æžœï¼š**
- è¿”å›ž Markdown + LaTeX æ ¼å¼çš„æ•°å­¦é¢˜
- æ¯é¡µå•ç‹¬æ ‡æ³¨ä¸º "ç¬¬ 1 é¡µ"ã€"ç¬¬ 2 é¡µ" ç­‰
- æ‰€æœ‰å…¬å¼ä½¿ç”¨ `$$...$$` æˆ– `$...$` æ ¼å¼

#### ç¤ºä¾‹ 2: å¤„ç†å›¾ç‰‡æ–‡ä»¶

```
åœ¨ OpenCode å¯¹è¯ä¸­è¾“å…¥ï¼š
è¯·è¯†åˆ« ~/Desktop/math_problem.jpg ä¸­çš„æ•°å­¦é¢˜
```

**é¢„æœŸç»“æžœï¼š**
- è¯†åˆ«å›¾ç‰‡ä¸­çš„æ•°å­¦å…¬å¼ã€å‡ ä½•å›¾å½¢
- è¿”å›žæ ¼å¼åŒ–çš„ Markdown æ–‡æœ¬
- LaTeX å…¬å¼å‡†ç¡®è½¬æ¢

#### ç¤ºä¾‹ 3: æ‰¹é‡å¤„ç†

```
åœ¨ OpenCode å¯¹è¯ä¸­è¾“å…¥ï¼š
è¯·ä¾æ¬¡è¯»å–ä»¥ä¸‹æ–‡ä»¶ï¼š
1. /Users/gubin/Desktop/test_1.pdf
2. /Users/gubin/Desktop/test_2.pdf
3. /Users/gubin/Desktop/test_3.pdf
```

**é¢„æœŸç»“æžœï¼š**
- é€ä¸ªå¤„ç†æ¯ä¸ªæ–‡ä»¶
- æŒ‰æ–‡ä»¶åˆ†ç»„è¿”å›žç»“æžœ

### âš ï¸ å¸¸è§é—®é¢˜ (Common Issues)

#### é—®é¢˜ 1: æ¨¡å—å¯¼å…¥é”™è¯¯

**é”™è¯¯ä¿¡æ¯ï¼š**
```
ImportError: attempted relative import with no known parent package
```

**åŽŸå› ï¼š**
ç›´æŽ¥è¿è¡Œ Python æ—¶ï¼Œç›¸å¯¹å¯¼å…¥æ— æ³•è¯†åˆ«åŒ…ç»“æž„

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# ä½¿ç”¨è¿è¡Œè„šæœ¬
./run_server.sh

# æˆ–ä½¿ç”¨ Python -m
python3 -m src.server
```

#### é—®é¢˜ 2: API å¯†é’¥æœªè®¾ç½®

**é”™è¯¯ä¿¡æ¯ï¼š**
```
ValidationError: SILICONFLOW_API_KEY environment variable is required
```

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ£€æŸ¥çŽ¯å¢ƒå˜é‡
echo $SILICONFLOW_API_KEY

# è®¾ç½® API å¯†é’¥
export SILICONFLOW_API_KEY=your-key-here

# æˆ–åˆ›å»º .env æ–‡ä»¶
cat > .env << 'EOF'
SILICONFLOW_API_KEY=your-key-here
EOF
```

#### é—®é¢˜ 3: æ–‡ä»¶ä¸å­˜åœ¨

**é”™è¯¯ä¿¡æ¯ï¼š**
```
ValidationError: File not found: /path/to/file.pdf
```

**è§£å†³æ–¹æ¡ˆï¼š**
- ç¡®è®¤æ–‡ä»¶è·¯å¾„æ­£ç¡®
- ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼ˆä»¥ `/` å¼€å¤´ï¼‰
- éªŒè¯æ–‡ä»¶å­˜åœ¨ï¼š`ls -la /path/to/file.pdf`

#### é—®é¢˜ 4: ä¸æ”¯æŒçš„æ–‡ä»¶ç±»åž‹

**é”™è¯¯ä¿¡æ¯ï¼š**
```
ValidationError: Unsupported file type: .txt
```

**æ”¯æŒçš„æ ¼å¼ï¼š**
- PDF: `.pdf`
- å›¾ç‰‡: `.jpg`, `.jpeg`, `.png`

**ä¸æ”¯æŒï¼š**
- `.txt`, `.doc`, `.docx`

### ðŸ“– æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ (Supported File Formats)

| æ ¼å¼ | æ‰©å±•å | è¯´æ˜Ž | æœ€å¤§å¤§å° |
|--------|----------|------|--------|
| PDF | `.pdf` | å¤šé¡µæ–‡æ¡£ | 10 MB |
| JPEG | `.jpg`, `.jpeg` | å¸¸è§å›¾ç‰‡æ ¼å¼ | 10 MB |
| PNG | `.png` | æ”¯æŒé€æ˜ŽèƒŒæ™¯ | 10 MB |

### ðŸ”’ å®‰å…¨ç‰¹æ€§ (Security Features)

- âœ… **è·¯å¾„éåŽ†ä¿æŠ¤** - æ£€æµ‹å¹¶é˜»æ­¢ `../` æ”»å‡»
- âœ… **æ–‡ä»¶ç±»åž‹éªŒè¯** - ä»…å…è®¸å®‰å…¨çš„æ–‡ä»¶æ ¼å¼
- âœ… **æ–‡ä»¶å¤§å°é™åˆ¶** - é»˜è®¤æœ€å¤§ 10 MB
- âœ… **ç»å¯¹è·¯å¾„è¦æ±‚** - å¼ºåˆ¶ä½¿ç”¨ç»å¯¹è·¯å¾„
- âœ… **API å¯†é’¥ä¿æŠ¤** - ä¸åœ¨æ—¥å¿—ä¸­æ˜¾ç¤ºå®Œæ•´å¯†é’¥

### ðŸ“ˆ æ€§èƒ½ç‰¹æ€§ (Performance Features)

- âœ… **API é‡è¯•æœºåˆ¶** - å¤±è´¥è‡ªåŠ¨é‡è¯•æœ€å¤š 3 æ¬¡
- âœ… **æŒ‡æ•°é€€é¿** - é‡è¯•é—´éš”é€æ¸å¢žåŠ 
- âœ… **è¿žæŽ¥è¶…æ—¶å¤„ç†** - å‹å¥½çš„è¶…æ—¶é”™è¯¯æ¶ˆæ¯
- âœ… **å¼‚æ­¥å¤„ç†** - ä½¿ç”¨ asyncio è¿›è¡Œé«˜æ•ˆå¹¶å‘

### ðŸ“š æ–‡æ¡£èµ„æº (Documentation Resources)

- **opencode.md** - å®Œæ•´çš„ä½¿ç”¨æ–‡æ¡£
- **DEPLOYMENT.md** - è¯¦ç»†çš„éƒ¨ç½²æŒ‡å—
- **.env.example** - çŽ¯å¢ƒå˜é‡æ¨¡æ¿
- **run_server.sh** - æœåŠ¡å™¨å¯åŠ¨è„šæœ¬
- **README.md** - é¡¹ç›®æ¦‚è¿°ï¼ˆå¦‚æžœéœ€è¦ï¼‰

### ðŸŽ“ ä¸‹ä¸€æ­¥ (Next Steps)

1. **é…ç½® API å¯†é’¥**
   ```bash
   export SILICONFLOW_API_KEY=your-actual-api-key-from-siliconflow
   ```

2. **åœ¨ OpenCode ä¸­é…ç½® MCP**
   - æ‰“å¼€ OpenCode settings.json
   - æ·»åŠ  wrongmath MCP é…ç½®
   - é‡å¯ OpenCode

3. **æµ‹è¯•åŸºæœ¬åŠŸèƒ½**
   ```
   ä½ æœ‰å“ªäº›å¯ç”¨çš„å·¥å…·ï¼Ÿ
   è¯·è¯»å– /path/to/test.pdf
   ```

4. **å¤„ç†çœŸå®žæ–‡ä»¶**
   - æµ‹è¯•çŽ°æœ‰çš„ PDF æ–‡ä»¶ï¼š
     - è±†åŒ…çˆ±å­¦-é”™é¢˜ç»„å·-20260110_1.pdf (1.64 MB)
     - è±†åŒ…çˆ±å­¦-é”™é¢˜ç»„å·-20260110_2.pdf (1.85 MB)
     - è±†åŒ…çˆ±å­¦-é”™é¢˜ç»„å·-20260110_3.pdf (1.22 MB)

5. **æŸ¥çœ‹æ—¥å¿—**
   - æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—è¾“å‡º
   - æ ¹æ®éœ€è¦è°ƒæ•´æ—¥å¿—çº§åˆ«

### ðŸŽ‰ æ€»ç»“ (Summary)

âœ… **WrongMath MCP Server å·²å®Œå…¨éƒ¨ç½²å¹¶å¯ä»¥ä½¿ç”¨ï¼**

**é¡¹ç›®çŠ¶æ€ï¼š**
- ðŸ—ï¸ å®Œæ•´çš„ MCP æœåŠ¡å™¨å®žçŽ°
- ðŸ§ª å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼ˆ67% é€šè¿‡çŽ‡ï¼‰
- ðŸ“– è¯¦ç»†çš„éƒ¨ç½²æ–‡æ¡£
- ðŸš€ ç”Ÿäº§å°±ç»ª

**æŠ€æœ¯æ ˆï¼š**
- Python 3.8+
- MCP (Model Context Protocol)
- SiliconFlow DeepSeek-OCR API
- PyMuPDF (PDF å¤„ç†)
- Pillow (å›¾åƒå¤„ç†)

**æ„Ÿè°¢ä½¿ç”¨ WrongMath MCP Serverï¼** ðŸ™

---

*å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·å‚è€ƒ DEPLOYMENT.md èŽ·å–è¯¦ç»†çš„éƒ¨ç½²æŒ‡å—å’Œæ•…éšœæŽ’é™¤ã€‚*